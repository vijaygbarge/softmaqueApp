
<!DOCTYPE html>
<html>
<head>
    <link href="css/bootstrap.css" rel="stylesheet" />
    <link href="css/style.css" rel="stylesheet" />
    <script src="js/jquery.min.js"></script>
    <title>Softmaque App</title>
    <script>

        var url = 'source.html';


        /**
 * Make a X-Domain request to url and callback.
 *
 * @param url {String}
 * @param method {String} HTTP verb ('GET', 'POST', 'DELETE', etc.)
 * @param data {String} request body
 * @param callback {Function} to callback on completion
 * @param errback {Function} to callback on error
 */
        //method = 'GET';
        //da = '';
        //callbk = function (d) {
        //    alert(d);
        //}
        //xdr(url, method, da, callbk, callbk);


        //function xdr(url, method, data, callback, errback) {
        //    var req;

        //    if (XMLHttpRequest) {
        //        req = new XMLHttpRequest();

        //        if ('withCredentials' in req) {
        //            req.open(method, url, true);
        //            req.onerror = errback;
        //            req.onreadystatechange = function () {
        //                if (req.readyState === 4) {
        //                    if (req.status >= 200 && req.status < 400) {
        //                        callback(req.responseText);
        //                    } else {
        //                        errback(new Error('Response returned with non-OK status'));
        //                    }
        //                }
        //            };
        //            req.send(data);
        //        }
        //    } else if (XDomainRequest) {
        //        req = new XDomainRequest();
        //        req.open(method, url);
        //        req.onerror = errback;
        //        req.onload = function () {
        //            callback(req.responseText);
        //        };
        //        req.send(data);
        //    } else {
        //        errback(new Error('CORS not supported'));
        //    }
        //}
        //]]>

        //$.ajax({
        //    url: 'http://192.168.0.232/cgi-bin/login_page.tcl',
        //    type: 'GET',
        //    success: function (res) {
        //        var headline = $(res.responseText).find('#loginForm').html();
        //        alert(headline);
        //    }

        //});
        //$.ajax({
        //    async: false,
        //    url: url,
        //    crossDomain: true,
        //    dataType: "json",
        //    type: "POST",
        //    contentType: "application/json; charset=utf-8",
        //    success: function (data) {
        //        innerD = $(data).find('#loginForm');
        //        //Production
        //        var TotalPro = innerD.find('.circleTotalProd .circleValue label').text().replace(/[^0-9\.]/gi, '');
        //        var TodayPro = innerD.find('.circleTotalProd .circleDesc label').text().replace(/[^0-9\.]/gi, '');
        //        //Co2 comsuption
        //        var TotalCO2 = innerD.find('.circleCo2 .circleValue label').text().replace(/[^0-9\.]/gi, '');
        //        var TotalBags = innerD.find('.circleCo2 .circleDesc label').text().replace(/[^0-9\.]/gi, '');
        //        //Power output
        //        var PowerOutput = innerD.find('.circlePwrOutput .circleValue label').text().replace(/[^0-9\.]/gi, '');

        //        $('#lblTotalPro').text(TotalPro.length)
        //        $('#lblTodayPro').text(TodayPro.length);
        //        $('#lblTotalCO2').text(TotalCO2.length)
        //        $('#lblTotalBags').text(TotalBags.length);
        //        $('#lblPowerOutput').text(PowerOutput.length);
        //    }
        //});
        $.ajax({
            type: 'GET',
            url: 'http://192.168.140.99/ajax/index.html',
            data: null,
            dataType: 'text',
            success: function (response) {
                console.log(response);
            },
            xhrFields: {
                withCredentials: true
            },
            error: function (error) {
                console.log('ERROR:', error);
            }
        });
        $.get(url, function (data) {
            innerD = $(data).find('#loginForm');
            //Production
            var TotalPro = innerD.find('.circleTotalProd .circleValue label').text().replace(/[^0-9\.]/gi, '');
            var TodayPro = innerD.find('.circleTotalProd .circleDesc label').text().replace(/[^0-9\.]/gi, '');
            //Co2 comsuption
            var TotalCO2 = innerD.find('.circleCo2 .circleValue label').text().replace(/[^0-9\.]/gi, '');
            var TotalBags = innerD.find('.circleCo2 .circleDesc label').text().replace(/[^0-9\.]/gi, '');
            //Power output
            var PowerOutput = innerD.find('.circlePwrOutput .circleValue label').text().replace(/[^0-9\.]/gi, '');

            $('#lblTotalPro').text(TotalPro.length)
            $('#lblTodayPro').text(TodayPro.length);
            $('#lblTotalCO2').text(TotalCO2.length)
            $('#lblTotalBags').text(TotalBags.length);
            $('#lblPowerOutput').text(PowerOutput.length);
        });

        $('#textDiv').load('/source.html');
    </script>
</head>
<body>
    <div id="textDiv"></div>
    <nav class="navbar navbar-default">
        <div class="container-fluid">
            <div class="navbar-header">
                <a class="navbar-brand" href="#">
                    <img alt="Brand" src="icon.png" width="20" height="20" />
                </a>
            </div>
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-4">
                <p class="navbar-text">Bajaj Hospital 100kWP</p>
            </div>
        </div>
    </nav>
    <div id="PanelInfo" class="text-center">
        <div class="row">
            <div class="col-lg-6">
                <img class="panel-icon" src="img/info-icon-1.png" alt="" />
                <h1 class="panel-count"><label id="lblTotalPro">000</label>MWh</h1>
                <p class="panel-title">Total Production</p>
            </div>
            <div class="col-lg-6">
                <img class="panel-icon" src="img/info-icon-2.png" alt="" />
                <h1 class="panel-count"><label id="lblTodayPro">000</label>kWh</h1>
                <p class="panel-title">Today Produced</p>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-4">
                <img class="panel-icon" src="img/info-icon-3.png" alt="" />
                <h1 class="panel-count"><label id="lblTotalCO2">0</label> Ton</h1>
                <p class="panel-title">Total CO2 saved</p>
            </div>
            <div class="col-lg-4">
                <img class="panel-icon" src="img/info-icon-4.png" alt="" />
                <h1 class="panel-count"><label id="lblTotalBags">0</label></h1>
                <p class="panel-title">Equal to plastic bags produced</p>
            </div>
            <div class="col-lg-4">
                <img class="panel-icon" src="img/info-icon-5.png" alt="" />
                <h1 class="panel-count"><label id="lblPowerOutput">000</label>kW</h1>
                <p class="panel-title">Power output</p>
            </div>
        </div>
    </div>
</body>
</html>
